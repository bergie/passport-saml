var Saml = require('../lib/passport-saml/saml.js').SAML;
var saml = new Saml();

var samlResponse = "PHNhbWxwOlJlc3BvbnNlIElEPSJfMTBmMzBlZGYtYTVjNi00NWFmLTkyMWUtMjVjZDkxZTNmOWY5IiBWZXJzaW9uPSIyLjAiIElzc3VlSW5zdGFudD0iMjAxMy0wNi0yN1QyMzoyOToyNS4yMTVaIiBEZXN0aW5hdGlvbj0iaHR0cHM6Ly93d3cuZ3JvdXBwbGFjZS5jb20vc2FtbENhbGxiYWNrP3NhbWxDb25maWc9TmV1ZGVzaWMlMjBFbnRlcnByaXNlJmFtcDtzdWJkb21haW49bGRhcC1zeW5jLW5ldHdvcmsiIENvbnNlbnQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpjb25zZW50OnVuc3BlY2lmaWVkIiBJblJlc3BvbnNlVG89Il83NmJlMDI0NjE3ZTY4NDg3NzEyNyIgeG1sbnM6c2FtbHA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCI+PElzc3VlciB4bWxucz0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiI+aHR0cDovL3N0czEubmV1ZGVzaWMuY29tL2FkZnMvc2VydmljZXMvdHJ1c3Q8L0lzc3Vlcj48c2FtbHA6U3RhdHVzPjxzYW1scDpTdGF0dXNDb2RlIFZhbHVlPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6c3RhdHVzOlN1Y2Nlc3MiIC8+PC9zYW1scDpTdGF0dXM+PEFzc2VydGlvbiBJRD0iXzgyYjBhY2U3LTBkMDItNGMwZi04NWRhLTc1NjZlM2U3NDg4YSIgSXNzdWVJbnN0YW50PSIyMDEzLTA2LTI3VDIzOjI5OjI1LjIxNVoiIFZlcnNpb249IjIuMCIgeG1sbnM9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPjxJc3N1ZXI+aHR0cDovL3N0czEubmV1ZGVzaWMuY29tL2FkZnMvc2VydmljZXMvdHJ1c3Q8L0lzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj48ZHM6U2lnbmVkSW5mbz48ZHM6Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIgLz48ZHM6U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3JzYS1zaGExIiAvPjxkczpSZWZlcmVuY2UgVVJJPSIjXzgyYjBhY2U3LTBkMDItNGMwZi04NWRhLTc1NjZlM2U3NDg4YSI+PGRzOlRyYW5zZm9ybXM+PGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNlbnZlbG9wZWQtc2lnbmF0dXJlIiAvPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiIC8+PC9kczpUcmFuc2Zvcm1zPjxkczpEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMSIgLz48ZHM6RGlnZXN0VmFsdWU+Z2lxVVA1N3hIUG5nSE1tTWpFaE94OVBZYjlZPTwvZHM6RGlnZXN0VmFsdWU+PC9kczpSZWZlcmVuY2U+PC9kczpTaWduZWRJbmZvPjxkczpTaWduYXR1cmVWYWx1ZT5jSEROZjI1SkM3blUwMXRMVmo0cDRPSUJUZkRJbmtJV1RiWVhyWlEwVlJPUkI4WXVUS3BYaU84RnR6bWh0YXBnWXd1dE4vTlpDT2ErdWs0R21pQjdYL2VsMTV2TUVLOGhEREtNTUFBZUxuTjZQZ1RKV2VxSHVRZXlnMEpxTFdueDRGME50TjRPQVZSVVg5Z0NYUzJVWlhhWDVrTjhteWZJZUJMb2hablYwTTl3b3V4c2FYWlRTWVdXVlZrMVBOREYrSU4wWGdVWUI1dStianJEajhXVXZnb3pTZlhkNGhDbXF1eE1ER3VqNXdPWDkxV3ovOFptaHZ2UkNrSTRuY0lMTVVueS9ZL2ZrZUYyaWtiYjllQ2Fvd3pYT3k0dG12U2U3WEhMZkhpTm41WFJCMHpPUnpISGxpbkFZUEQwTmJLdzdZeVMyU1JZVHdDc0dKNElUdDRuWFE9PTwvZHM6U2lnbmF0dXJlVmFsdWU+PEtleUluZm8geG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjxkczpYNTA5RGF0YT48ZHM6WDUwOUNlcnRpZmljYXRlPk1JSUMzakNDQWNhZ0F3SUJBZ0lRV21wcWU2Y3p4WjFKc1k0S3Z3STFEakFOQmdrcWhraUc5dzBCQVFzRkFEQXJNU2t3SndZRFZRUURFeUJCUkVaVElGTnBaMjVwYm1jZ0xTQnpkSE14TG01bGRXUmxjMmxqTG1OdmJUQWVGdzB4TWpFd01Ua3hORFEyTWpOYUZ3MHhNekV3TVRreE5EUTJNak5hTUNzeEtUQW5CZ05WQkFNVElFRkVSbE1nVTJsbmJtbHVaeUF0SUhOMGN6RXVibVYxWkdWemFXTXVZMjl0TUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFybmhMQ2V5azFBb1BRblR6a0sxVjNheGwrY3NBd01vUSt6SUhMZjhjTnVITS9JcG9ZR3krWmR2dnlaSWw1WXVwVTlhL0tOZ1UySEVkVVFNVG1tVHhnUThwNTlXOEhBZXhHVENBdlNqQnhTcFlPQjZQZlZNRlNjNUVoOGgyWUZoT0xIaFpmR0FCVU40WHZUcSsvUG5od1pOVm8xYWk5Y3Z3MWN3eTY5aCtmRGYrQnB5RlByVit5dnVmdFRVeFJCWnJkaUhmZGNpYktVa21sczZaVzVqdHdpR2RhNjZjMkZndlpueStlOGtaYnJjTS9mWWlRdVNzYmZiaUJmdVNlckFjUlp0TFlqbHFhMGdWZ3QyQ0g0YXJRZVJGYWZEWWN2NXNKRnNDV0N0NndQbE1vcW1Yc01DMmFMOGUrTFg4VjZmYXJGWmhGSjlpbTFQbzdUL3hqV0FZQ1FJREFRQUJNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJrMU5EL2ZLeFBkL1BHTVRWVnY3bUxabFNRQjZ2SThteUhKTEdGZ2xnWFpuYjNSOWVyL2ZoM2VUZlRBQ2JRcmFVSGtSSWtGOGVEYytuN050RWVFT1JOdW04aFhqcHBLZ0xXUUJXMWUzQkdMOFJsWjlZMXlzeitxUWNJeWMwYnVZYmYwWTRMWVg4eFRqZDNpQ0ZWb3Z6SkNPTzlPWTNrRVllNU9lVllLeVR6TG5oeUtWVnJKaVRMUlhSZ3RtZnRwUFlDVVpsSzdiSHhXK0ZibkxMMjUvaURwWHhFaDZjM1IwTXhkTm1icDUybFhiRE5EZmN1RG5GZkkxNmI4TEFWdThOS2pyYkNFRWllclpRUTg0cFBmRUp3MHg0c2NhNkhueWFEQ3Uvb09GWUFvcU4vNFEzdWV3ZTB2cVY2R2NhOElsVUJuWlM5MktkSDdiQlNZcThoS1N3ajwvZHM6WDUwOUNlcnRpZmljYXRlPjwvZHM6WDUwOURhdGE+PC9LZXlJbmZvPjwvZHM6U2lnbmF0dXJlPjxTdWJqZWN0PjxTdWJqZWN0Q29uZmlybWF0aW9uIE1ldGhvZD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmNtOmJlYXJlciI+PFN1YmplY3RDb25maXJtYXRpb25EYXRhIEluUmVzcG9uc2VUbz0iXzc2YmUwMjQ2MTdlNjg0ODc3MTI3IiBOb3RPbk9yQWZ0ZXI9IjIwMTMtMDYtMjdUMjM6MzQ6MjUuMjE1WiIgUmVjaXBpZW50PSJodHRwczovL3d3dy5ncm91cHBsYWNlLmNvbS9zYW1sQ2FsbGJhY2s/c2FtbENvbmZpZz1OZXVkZXNpYyUyMEVudGVycHJpc2UmYW1wO3N1YmRvbWFpbj1sZGFwLXN5bmMtbmV0d29yayIgLz48L1N1YmplY3RDb25maXJtYXRpb24+PC9TdWJqZWN0PjxDb25kaXRpb25zIE5vdEJlZm9yZT0iMjAxMy0wNi0yN1QyMzoyOToyNS4yMTVaIiBOb3RPbk9yQWZ0ZXI9IjIwMTMtMDYtMjhUMDA6Mjk6MjUuMjE1WiI+PEF1ZGllbmNlUmVzdHJpY3Rpb24+PEF1ZGllbmNlPmh0dHBzOi8vd3d3Lmdyb3VwcGxhY2UuY29tL3NhbWxDYWxsYmFjazwvQXVkaWVuY2U+PC9BdWRpZW5jZVJlc3RyaWN0aW9uPjwvQ29uZGl0aW9ucz48QXR0cmlidXRlU3RhdGVtZW50PjxBdHRyaWJ1dGUgTmFtZT0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvZW1haWxhZGRyZXNzIj48QXR0cmlidXRlVmFsdWU+SmVzcy5TaGVuZWJlcmdlckBuZXVkZXNpYy5jb208L0F0dHJpYnV0ZVZhbHVlPjwvQXR0cmlidXRlPjxBdHRyaWJ1dGUgTmFtZT0ib2JqZWN0R1VJRCI+PEF0dHJpYnV0ZVZhbHVlPm53eFJWaEI0eDAya2YxNUlVQlJWb3c9PTwvQXR0cmlidXRlVmFsdWU+PC9BdHRyaWJ1dGU+PC9BdHRyaWJ1dGVTdGF0ZW1lbnQ+PEF1dGhuU3RhdGVtZW50IEF1dGhuSW5zdGFudD0iMjAxMy0wNi0yN1QyMzoyOToyNS4xMzdaIj48QXV0aG5Db250ZXh0PjxBdXRobkNvbnRleHRDbGFzc1JlZj51cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZFByb3RlY3RlZFRyYW5zcG9ydDwvQXV0aG5Db250ZXh0Q2xhc3NSZWY+PC9BdXRobkNvbnRleHQ+PC9BdXRoblN0YXRlbWVudD48L0Fzc2VydGlvbj48L3NhbWxwOlJlc3BvbnNlPg==";
//var cert = "MIIC3jCCAcagAwIBAgIQZUWpekgMvbRAgxD7CteRHzANBgkqhkiG9w0BAQsFADArMSkwJwYDVQQDEyBBREZTIFNpZ25pbmcgLSBzdHMxLm5ldWRlc2ljLmNvbTAeFw0xMDExMjQwMDM2MTVaFw0xMTExMjQwMDM2MTVaMCsxKTAnBgNVBAMTIEFERlMgU2lnbmluZyAtIHN0czEubmV1ZGVzaWMuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAil619wY59lB5C65fu6OTmtHdRG2271yo8fTjZoOE3NN2to/oGSSfuVyodSqyRRIdZiveRmFDDqKNKyj2x6Cl47ED7htrcgssDJt0RFfPwaHQyPKjswJVs/rdTY9LnFHS9sZNQzrXdyuaFq35B4TnMtTjulXD52t8jTS8cHWHf7iJzh1HKUaolz/IglbKkqyI+EioTDSD0FpxpmKVWrNTx3yHJJ0DKufbol1fpE+pkCszYtdF4fjwmpc/WM3eNUsBX07zoSnNI9cjDyQP1jSthugMzYaH/hbL+ROS6scyTLkDGpVcgg7zrMv2FxaSFr4a7vE635TjdlQFU00QaCT0vQIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQCHk7ksZI5V0H/fxJQTvT6hgkBWcyHzzoibbSlJYUnmzFixs2+N305S7gftsoa348giBjrAqyLHtLyCqafRRJEoSqMNrjr6giq6J6U906y1Ku2IB5rbhAImwx7uXw9rzF7zD4hdJ9UBhKAGHBaPNv/t+Anpk7WnZdto+5Q4uGVIcWh0/G5bISnN6rwGBBRfWch9/nYpbK13XhO1h753dYyM3HvJYCG33c8fzPHuBHZG+3L9M4hTO7Esl9l8ukXM1Sd/xDkiCz3zUFW4ab1egaGchdyGpqfUAwk8yjBYchJARepUWwa+6ATBkn/34AGhaYlrXMYLQrVairR2wCI5cwr5";
var cert = "MIIC3jCCAcagAwIBAgIQWmpqe6czxZ1JsY4KvwI1DjANBgkqhkiG9w0BAQsFADArMSkwJwYDVQQDEyBBREZTIFNpZ25pbmcgLSBzdHMxLm5ldWRlc2ljLmNvbTAeFw0xMjEwMTkxNDQ2MjNaFw0xMzEwMTkxNDQ2MjNaMCsxKTAnBgNVBAMTIEFERlMgU2lnbmluZyAtIHN0czEubmV1ZGVzaWMuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArnhLCeyk1AoPQnTzkK1V3axl+csAwMoQ+zIHLf8cNuHM/IpoYGy+ZdvvyZIl5YupU9a/KNgU2HEdUQMTmmTxgQ8p59W8HAexGTCAvSjBxSpYOB6PfVMFSc5Eh8h2YFhOLHhZfGABUN4XvTq+/PnhwZNVo1ai9cvw1cwy69h+fDf+BpyFPrV+yvuftTUxRBZrdiHfdcibKUkmls6ZW5jtwiGda66c2FgvZny+e8kZbrcM/fYiQuSsbfbiBfuSerAcRZtLYjlqa0gVgt2CH4arQeRFafDYcv5sJFsCWCt6wPlMoqmXsMC2aL8e+LX8V6farFZhFJ9im1Po7T/xjWAYCQIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQBk1ND/fKxPd/PGMTVVv7mLZlSQB6vI8myHJLGFglgXZnb3R9er/fh3eTfTACbQraUHkRIkF8eDc+n7NtEeEORNum8hXjppKgLWQBW1e3BGL8RlZ9Y1ysz+qQcIyc0buYbf0Y4LYX8xTjd3iCFVovzJCOO9OY3kEYe5OeVYKyTzLnhyKVVrJiTLRXRgtmftpPYCUZlK7bHxW+FbnLL25/iDpXxEh6c3R0MxdNmbp52lXbDNDfcuDnFfI16b8LAVu8NKjrbCEEierZQQ84pPfEJw0x4sca6HnyaDCu/oOFYAoqN/4Q3uewe0vqV6Gca8IlUBnZS92KdH7bBSYq8hKSwj";
var xml = new Buffer(samlResponse, 'base64').toString('ascii');
console.log('raw xml of response:');
console.log(xml);


var result = saml.validateXmlSignature(xml, cert);

if (result) {
	console.log('Success!');
} else {
	console.log('Failure.');
}
